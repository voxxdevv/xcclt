<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Xcode CLI Terminal</title>
</head>
<body style="margin: 0; padding: 0; font-family: 'Menlo', 'Monaco', monospace; background-color: #000000; color: #FFFFFF;">
    <div id="terminal" style="width: 100vw; height: 100vh; overflow: auto; padding: 10px; box-sizing: border-box;">
        <div id="output">
            <div style="color: #7F7F7F;">xcrun: Xcode Command Line Tools - Terminal Simulator</div>
            <div style="color: #7F7F7F;">Copyright (c) 2023 Apple Inc. All rights reserved.</div>
            <div style="color: #7F7F7F;">xcrun version 64 (64).</div>
            <div style="color: #7F7F7F;">Type 'help' for a list of commands.</div>
            <div style="margin-top: 10px">$ <span class="command-span"></span><span id="cursor" style="background-color: #FFFFFF; color: #000000; animation: blink 1s infinite;">_</span></div>
        </div>
    </div>

    <style>
        @keyframes blink {
            0%, 49% { opacity: 1; }
            50%, 100% { opacity: 0; }
        }
    </style>

    <script>
        // Terminal state
        const terminal = document.getElementById('terminal');
        const output = document.getElementById('output');
        let commandSpan = document.querySelector('.command-span');
        let currentCommand = '';
        let commandHistory = [];
        let historyIndex = -1;
        let currentDirectory = '/Users/user/Developer';
        let projectCreated = false;
        let currentProject = null;
        let buildSuccess = false;

        // File system simulation
        const fileSystem = {
            '/Users/user/Developer': {
                type: 'directory',
                contents: {}
            }
        };

        // Available Xcode templates
        const xcodeTemplates = [
            'macOS/App',
            'macOS/Command Line Tool',
            'macOS/Framework',
            'macOS/Library',
            'iOS/App',
            'iOS/Framework',
            'iOS/Library',
            'watchOS/App',
            'watchOS/Framework',
            'tvOS/App',
            'tvOS/Framework',
            'Swift Package',
            'Multi-platform/App',
            'Multi-platform/Framework'
        ];

        // Command implementations
        const commands = {
            'help': function() {
                return `
Available commands:
  cd [directory]                  - Change directory
  ls [directory]                  - List directory contents
  pwd                             - Print working directory
  mkdir [directory]               - Create a directory
  rm [-r] [file/directory]        - Remove file or directory
  xcode-select --version          - Display Xcode command line tools version
  xcode-select --print-path       - Print developer directory path
  swift --version                 - Display Swift version
  xcrun --version                 - Display xcrun version
  xcodebuild -version             - Display Xcode version
  xcodebuild -list                - List available schemes (in a project)
  xcodebuild -list -project [project] - List schemes in specified project
  xcodebuild -showsdks            - List available SDKs

Project commands:
  xcode-create [name] [template]  - Create a new Xcode project
                                     Use xcode-list-templates to see available templates
  xcode-list-templates            - List available project templates
  xcode-build [project]           - Build a project
  xcode-run [project]             - Build and run a project
  xcode-clean [project]           - Clean a project
  xcode-test [project]            - Run tests for a project
  xcode-open [project]            - Open a project in Xcode (simulated)
  
  clear                           - Clear the terminal screen
                `;
            },
            
            'cd': function(args) {
                if (!args || args === '~') {
                    currentDirectory = '/Users/user';
                    return '';
                }
                
                let targetPath;
                if (args.startsWith('/')) {
                    targetPath = args;
                } else {
                    targetPath = currentDirectory + '/' + args;
                }
                
                // Normalize path (handle '..' and '.')
                const parts = targetPath.split('/').filter(Boolean);
                const resolvedParts = [];
                for (const part of parts) {
                    if (part === '..') {
                        resolvedParts.pop();
                    } else if (part !== '.') {
                        resolvedParts.push(part);
                    }
                }
                targetPath = '/' + resolvedParts.join('/');
                
                // Check if directory exists
                if (getFileSystemObject(targetPath)?.type === 'directory') {
                    currentDirectory = targetPath;
                    return '';
                } else {
                    return `cd: ${args}: No such file or directory`;
                }
            },
            
            'pwd': function() {
                return currentDirectory;
            },
            
            'ls': function(args) {
                const path = args || currentDirectory;
                const fsObj = getFileSystemObject(path);
                
                if (!fsObj) {
                    return `ls: ${path}: No such file or directory`;
                }
                
                if (fsObj.type !== 'directory') {
                    return path.split('/').pop();
                }
                
                const contents = fsObj.contents;
                const result = [];
                
                for (const name in contents) {
                    if (contents[name].type === 'directory') {
                        result.push(`<span style="color: #3E9BFF;">${name}/</span>`);
                    } else if (name.endsWith('.swift')) {
                        result.push(`<span style="color: #FF7F50;">${name}</span>`);
                    } else if (name.endsWith('.xcodeproj')) {
                        result.push(`<span style="color: #4169E1;">${name}</span>`);
                    } else if (name.endsWith('.h')) {
                        result.push(`<span style="color: #9370DB;">${name}</span>`);
                    } else if (name.endsWith('.m') || name.endsWith('.mm')) {
                        result.push(`<span style="color: #32CD32;">${name}</span>`);
                    } else {
                        result.push(name);
                    }
                }
                
                return result.join('  ');
            },
            
            'mkdir': function(args) {
                if (!args) {
                    return 'mkdir: missing operand';
                }
                
                let targetPath;
                if (args.startsWith('/')) {
                    targetPath = args;
                } else {
                    targetPath = currentDirectory + '/' + args;
                }
                
                createDirectory(targetPath);
                return '';
            },
            
            'rm': function(args) {
                if (!args) {
                    return 'rm: missing operand';
                }
                
                const parts = args.split(' ').filter(Boolean);
                let recursive = false;
                let targetPath;
                
                if (parts[0] === '-r' || parts[0] === '-rf') {
                    recursive = true;
                    targetPath = parts[1];
                } else {
                    targetPath = parts[0];
                }
                
                if (!targetPath.startsWith('/')) {
                    targetPath = currentDirectory + '/' + targetPath;
                }
                
                const fsObj = getFileSystemObject(targetPath);
                if (!fsObj) {
                    return `rm: ${targetPath}: No such file or directory`;
                }
                
                if (fsObj.type === 'directory' && !recursive) {
                    return `rm: ${targetPath}: is a directory`;
                }
                
                // Remove the file or directory
                const parentPath = targetPath.substring(0, targetPath.lastIndexOf('/'));
                const fileName = targetPath.substring(targetPath.lastIndexOf('/') + 1);
                const parentDir = getFileSystemObject(parentPath);
                
                if (parentDir && parentDir.contents[fileName]) {
                    delete parentDir.contents[fileName];
                    return '';
                } else {
                    return `rm: ${targetPath}: No such file or directory`;
                }
            },
            
            'xcode-select --version': function() {
                return 'xcode-select version 2412.';
            },
            
            'xcode-select --print-path': function() {
                return '/Applications/Xcode.app/Contents/Developer';
            },
            
            'swift --version': function() {
                return 'Apple Swift version 5.8.1 (swiftlang-5.8.0.124.5 clang-1403.0.22.11.100)\nTarget: arm64-apple-macosx13.0';
            },
            
            'xcrun --version': function() {
                return 'xcrun version 64 (64).';
            },
            
            'xcodebuild -version': function() {
                return 'Xcode 14.3.1\nBuild version 14E300c';
            },
            
            'xcodebuild -list': function() {
                if (!projectCreated || !currentProject) {
                    return 'xcodebuild: error: No project was specified and none could be found in the current working directory.';
                }
                
                return `
Information about project "${currentProject}":
    Targets:
        ${currentProject}
        ${currentProject}Tests
        ${currentProject}UITests
    
    Build Configurations:
        Debug
        Release
    
    If no build configuration is specified and -scheme is not passed then "Debug" is used.
    
    Schemes:
        ${currentProject}
`;
            },
            
            'xcodebuild -showsdks': function() {
                return `
macOS SDKs:
    macOS 13.3                     -sdk macosx13.3

iOS SDKs:
    iOS 16.4                       -sdk iphoneos16.4

iOS Simulator SDKs:
    Simulator - iOS 16.4           -sdk iphonesimulator16.4

tvOS SDKs:
    tvOS 16.4                      -sdk appletvos16.4

tvOS Simulator SDKs:
    Simulator - tvOS 16.4          -sdk appletvsimulator16.4

watchOS SDKs:
    watchOS 9.4                    -sdk watchos9.4

watchOS Simulator SDKs:
    Simulator - watchOS 9.4        -sdk watchsimulator9.4

DriverKit SDKs:
    DriverKit 22.4                 -sdk driverkit22.4
`;
            },
            
            'xcode-list-templates': function() {
                return 'Available Xcode project templates:\n' + xcodeTemplates.join('\n');
            },
            
            'xcode-create': function(args) {
                if (!args) {
                    return 'Usage: xcode-create [project_name] [template]\nUse xcode-list-templates to see available templates.';
                }
                
                const parts = args.split(' ');
                const projectName = parts[0];
                const templateArg = parts.slice(1).join(' ');
                
                // Check if template exists
                const template = templateArg || 'macOS/Command Line Tool';
                if (!xcodeTemplates.includes(template)) {
                    return `Template "${template}" not found. Use xcode-list-templates to see available templates.`;
                }
                
                // Create project structure
                const projectPath = `${currentDirectory}/${projectName}`;
                createDirectory(projectPath);
                
                // Create project files based on template
                const projDir = getFileSystemObject(projectPath);
                
                if (template === 'macOS/Command Line Tool') {
                    projDir.contents[`${projectName}.xcodeproj`] = { type: 'file', content: `Xcode project for ${projectName}` };
                    createDirectory(`${projectPath}/Sources`);
                    createDirectory(`${projectPath}/Tests`);
                    
                    const sourcesDir = getFileSystemObject(`${projectPath}/Sources`);
                    sourcesDir.contents['main.swift'] = { 
                        type: 'file', 
                        content: `// ${projectName} - main.swift
import Foundation

print("Hello, World!")

func greet(person: String) -> String {
    let greeting = "Hello, " + person + "!"
    return greeting
}

// Test the function
let message = greet(person: "Xcode User")
print(message)
`
                    };
                    
                    const testsDir = getFileSystemObject(`${projectPath}/Tests`);
                    testsDir.contents[`${projectName}Tests.swift`] = { 
                        type: 'file', 
                        content: `// ${projectName}Tests - Unit Tests
import XCTest

final class ${projectName}Tests: XCTestCase {
    func testExample() throws {
        // This is an example of a functional test case.
        XCTAssertEqual(1 + 1, 2)
    }
}
`
                    };
                    
                    createDirectory(`${projectPath}/.build`);
                    projectCreated = true;
                    currentProject = projectName;
                    
                    return `Created ${template} project: ${projectName}\nProject structure initialized at ${projectPath}\n\nUse 'cd ${projectName}' to navigate to the project directory.\nUse 'xcode-build ${projectName}' to build the project.`;
                } else {
                    // Basic structure for other templates
                    projDir.contents[`${projectName}.xcodeproj`] = { type: 'file', content: `Xcode project for ${projectName} (${template})` };
                    createDirectory(`${projectPath}/Sources`);
                    createDirectory(`${projectPath}/Resources`);
                    createDirectory(`${projectPath}/Tests`);
                    
                    const sourcesDir = getFileSystemObject(`${projectPath}/Sources`);
                    
                    if (template.includes('App')) {
                        sourcesDir.contents['AppDelegate.swift'] = { type: 'file', content: `// AppDelegate for ${projectName}` };
                        sourcesDir.contents['ContentView.swift'] = { type: 'file', content: `// Main view for ${projectName}` };
                    } else {
                        sourcesDir.contents[`${projectName}.swift`] = { type: 'file', content: `// Main implementation for ${projectName}` };
                        sourcesDir.contents[`${projectName}.h`] = { type: 'file', content: `// Header for ${projectName}` };
                    }
                    
                    projectCreated = true;
                    currentProject = projectName;
                    
                    return `Created ${template} project: ${projectName}\nProject structure initialized at ${projectPath}\n\nUse 'cd ${projectName}' to navigate to the project directory.\nUse 'xcode-build ${projectName}' to build the project.`;
                }
            },
            
            'xcode-build': function(args) {
                const projectName = args || currentProject;
                
                if (!projectName) {
                    return 'xcodebuild: error: No project was specified and none could be found in the current working directory.';
                }
                
                // Check if project exists
                const projectPath = `${currentDirectory}/${projectName}`;
                const projectDirExists = getFileSystemObject(projectPath)?.type === 'directory';
                const xcodeProjectExists = projectDirExists && getFileSystemObject(projectPath).contents[`${projectName}.xcodeproj`];
                
                if (!projectDirExists || !xcodeProjectExists) {
                    return `xcodebuild: error: project '${projectName}' does not exist.`;
                }
                
                // Build output simulation
                buildSuccess = true;
                
                return `
=== BUILD TARGET ${projectName} OF PROJECT ${projectName} WITH CONFIGURATION Debug ===

Check dependencies
    Swift Compiler - Language Submodule               0.01 seconds
    Swift Compiler - AST Parsing and Generation       0.10 seconds
    Swift Compiler - Type Checking                    0.03 seconds
    Swift Compiler - Semantic Analysis                0.02 seconds
    Swift Compiler - Code Generation                  0.06 seconds
    Swift Compiler - SIL Generation                   0.04 seconds
    Swift Compiler - SIL Processing                   0.01 seconds
    Swift Compiler - LLVM Generation                  0.03 seconds
    Linking and Creation                              0.07 seconds

** BUILD SUCCEEDED ** [0.366 sec]
`;
            },
            
            'xcode-run': function(args) {
                const projectName = args || currentProject;
                
                if (!projectName) {
                    return 'xcodebuild: error: No project was specified and none could be found in the current working directory.';
                }
                
                // Check if project exists
                const projectPath = `${currentDirectory}/${projectName}`;
                const projectDirExists = getFileSystemObject(projectPath)?.type === 'directory';
                const xcodeProjectExists = projectDirExists && getFileSystemObject(projectPath).contents[`${projectName}.xcodeproj`];
                
                if (!projectDirExists || !xcodeProjectExists) {
                    return `xcodebuild: error: project '${projectName}' does not exist.`;
                }
                
                // Build first
                const buildOutput = commands['xcode-build'](projectName);
                if (!buildSuccess) {
                    return buildOutput;
                }
                
                // Run output simulation
                return `
${buildOutput}

=== RUNNING ${projectName} ===

Hello, World!
Hello, Xcode User!

Program ended with exit code: 0
`;
            },
            
            'xcode-clean': function(args) {
                const projectName = args || currentProject;
                
                if (!projectName) {
                    return 'xcodebuild: error: No project was specified and none could be found in the current working directory.';
                }
                
                // Check if project exists
                const projectPath = `${currentDirectory}/${projectName}`;
                const projectDirExists = getFileSystemObject(projectPath)?.type === 'directory';
                const xcodeProjectExists = projectDirExists && getFileSystemObject(projectPath).contents[`${projectName}.xcodeproj`];
                
                if (!projectDirExists || !xcodeProjectExists) {
                    return `xcodebuild: error: project '${projectName}' does not exist.`;
                }
                
                // Clean output simulation
                return `
=== CLEAN TARGET ${projectName} OF PROJECT ${projectName} WITH CONFIGURATION Debug ===

Check dependencies
Clean.Remove clean build directory "/Users/user/Library/Developer/Xcode/DerivedData/${projectName}-XXXXXXXX/Build/Products/Debug"
    cd ${projectPath}
    builtin-rm -rf /Users/user/Library/Developer/Xcode/DerivedData/${projectName}-XXXXXXXX/Build/Products/Debug

Clean.Remove clean build directory "/Users/user/Library/Developer/Xcode/DerivedData/${projectName}-XXXXXXXX/Build/Intermediates.noindex"
    cd ${projectPath}
    builtin-rm -rf /Users/user/Library/Developer/Xcode/DerivedData/${projectName}-XXXXXXXX/Build/Intermediates.noindex

** CLEAN SUCCEEDED ** [0.124 sec]
`;
            },
            
            'xcode-test': function(args) {
                const projectName = args || currentProject;
                
                if (!projectName) {
                    return 'xcodebuild: error: No project was specified and none could be found in the current working directory.';
                }
                
                // Check if project exists
                const projectPath = `${currentDirectory}/${projectName}`;
                const projectDirExists = getFileSystemObject(projectPath)?.type === 'directory';
                const xcodeProjectExists = projectDirExists && getFileSystemObject(projectPath).contents[`${projectName}.xcodeproj`];
                
                if (!projectDirExists || !xcodeProjectExists) {
                    return `xcodebuild: error: project '${projectName}' does not exist.`;
                }
                
                // Test output simulation
                return `
=== TEST ${projectName}Tests OF PROJECT ${projectName} WITH CONFIGURATION Debug ===

Test Suite '${projectName}Tests' started at 2023-05-30 10:15:32.123
Test Case '-[${projectName}Tests testExample]' started.
Test Case '-[${projectName}Tests testExample]' passed (0.001 seconds).
Test Suite '${projectName}Tests' passed at 2023-05-30 10:15:32.125.
     Executed 1 test, with 0 failures (0 unexpected) in 0.001 (0.002) seconds

** TEST SUCCEEDED ** [0.135 sec]
`;
            },
            
            'xcode-open': function(args) {
                const projectName = args || currentProject;
                
                if (!projectName) {
                    return 'xcodebuild: error: No project was specified and none could be found in the current working directory.';
                }
                
                // Check if project exists
                const projectPath = `${currentDirectory}/${projectName}`;
                const projectDirExists = getFileSystemObject(projectPath)?.type === 'directory';
                const xcodeProjectExists = projectDirExists && getFileSystemObject(projectPath).contents[`${projectName}.xcodeproj`];
                
                if (!projectDirExists || !xcodeProjectExists) {
                    return `xcodebuild: error: project '${projectName}' does not exist.`;
                }
                
                return `Opening project ${projectName}.xcodeproj in Xcode... (simulated)`;
            },
            
            'clear': function() {
                output.innerHTML = '';
                addNewLine(`$ <span class="command-span"></span><span id="cursor" style="background-color: #FFFFFF; color: #000000; animation: blink 1s infinite;">_</span>`);
                commandSpan = document.querySelector('.command-span');
                return null;  // Special case, don't add output
            },
            
            'cat': function(args) {
                if (!args) {
                    return 'cat: No file specified';
                }
                
                let filePath;
                if (args.startsWith('/')) {
                    filePath = args;
                } else {
                    filePath = currentDirectory + '/' + args;
                }
                
                const fsObj = getFileSystemObject(filePath);
                if (!fsObj) {
                    return `cat: ${args}: No such file or directory`;
                }
                
                if (fsObj.type === 'directory') {
                    return `cat: ${args}: Is a directory`;
                }
                
                return fsObj.content;
            }
        };

        // Helper functions for file system simulation
        function getFileSystemObject(path) {
            if (!path) return null;
            
            const parts = path.split('/').filter(Boolean);
            let current = fileSystem;
            
            if (path === '/') {
                return fileSystem;
            }
            
            for (const part of parts) {
                if (!current[part]) {
                    return null;
                }
                current = current[part];
            }
            
            return current;
        }
        
        function createDirectory(path) {
            const parts = path.split('/').filter(Boolean);
            let current = fileSystem;
            
            for (let i = 0; i < parts.length; i++) {
                const part = parts[i];
                const subpath = '/' + parts.slice(0, i + 1).join('/');
                
                if (!current[part]) {
                    // Create new directory
                    current[part] = {
                        type: 'directory',
                        contents: {}
                    };
                }
                
                current = current[part].contents;
            }
        }
        
        // Initialize the file system with some directories
        createDirectory('/Users/user');
        createDirectory('/Users/user/Developer');
        createDirectory('/Applications');
        
        // Handle command execution
        function executeCommand(cmd) {
            const trimmedCmd = cmd.trim();
            if (!trimmedCmd) return;
            
            // Add to history
            commandHistory.push(trimmedCmd);
            historyIndex = commandHistory.length;
            
            let result = '';
            let commandFound = false;
            
            // Check exact command matches first
            if (commands[trimmedCmd]) {
                result = commands[trimmedCmd]();
                commandFound = true;
            } else {
                // Parse command and arguments
                const parts = trimmedCmd.split(' ');
                const command = parts[0];
                const args = parts.slice(1).join(' ');
                
                // Check if command exists
                if (commands[command]) {
                    result = commands[command](args);
                    commandFound = true;
                }
            }
            
            if (!commandFound) {
                result = `zsh: command not found: ${trimmedCmd.split(' ')[0]}`;
            }
            
            // Special case for clear
            if (result === null) {
                return;
            }
            
            // Add output to terminal
            addNewLine(result);
            
            // Add new command line
            addNewLine(`$ <span class="command-span"></span><span id="cursor" style="background-color: #FFFFFF; color: #000000; animation: blink 1s infinite;">_</span>`);
            commandSpan = document.querySelector('.command-span');
            
            // Scroll to bottom
            terminal.scrollTop = terminal.scrollHeight;
        }
        
        function addNewLine(content) {
            const line = document.createElement('div');
            line.innerHTML = content;
            output.appendChild(line);
        }
        
        // Handle keyboard input
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Enter') {
                // Execute command
                executeCommand(currentCommand);
                currentCommand = '';
            } else if (e.key === 'Backspace') {
                // Remove last character
                currentCommand = currentCommand.slice(0, -1);
                commandSpan.textContent = currentCommand;
            } else if (e.key === 'ArrowUp') {
                // Previous command in history
                e.preventDefault();
                if (historyIndex > 0) {
                    historyIndex--;
                    currentCommand = commandHistory[historyIndex];
                    commandSpan.textContent = currentCommand;
                }
            } else if (e.key === 'ArrowDown') {
                // Next command in history
                e.preventDefault();
                if (historyIndex < commandHistory.length - 1) {
                    historyIndex++;
                    currentCommand = commandHistory[historyIndex];
                } else {
                    currentCommand = '';
                }
                commandSpan.textContent = currentCommand;
            } else if (e.key === 'Tab') {
                // Basic tab completion
                e.preventDefault();
                // Could implement path completion here
            } else if (e.key.length === 1 && !e.ctrlKey && !e.metaKey && !e.altKey) {
                // Normal character input
                currentCommand += e.key;
                commandSpan.textContent = currentCommand;
            }
            
            // Scroll to current command
            terminal.scrollTop = terminal.scrollHeight;
        });

        // Make sure clicks focus on the terminal
        document.addEventListener('click', function() {
            document.querySelector('#cursor').scrollIntoView();
        });

        // Initialize with focus
        window.onload = function() {
            document.querySelector('#cursor').scrollIntoView();
        };
    </script>
</body>
</html>
